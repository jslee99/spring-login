<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title th:text="|${member.username}님의 유저 정보 페이지|">유저 정보 페이지</title>
<script th:inline="javascript">
    var isFollowing = [[${isFollowing}]];

    window.onload = () => {
        if(isFollowing === true){
                document.getElementById("followingButton").innerText = 'follow';
            }else{
                document.getElementById('followingButton').innerText = 'not follow';
            }
    }

    onClickFollowingButton = (e) => {
        const http = new XMLHttpRequest();
        const url = "http://localhost:8080/user/" + [[${member.memberId}]] + "/follow";
        fetch(url)
            .then(response => {
                console.log(response);
                return response.json();
            })
            .then(json => {
                console.log(json);
                isFollowing = new Boolean(json);
                if(isFollowing){
                    e.innerText = 'follow';
                }else{
                    e.innerText = 'not follow';
                }
            })
    }
</script>
</head>
<body>
<h1 th:text="|${member.username}님의 유저 정보 페이지|">유저 정보 페이지</h1>
<hr/>



<div th:object="${member}">
    <p th:field="*{username}" th:text="|username : *{username}|"></p>
    <p th:field="*{email}" th:text="|email : *{email}|"></p>
    <p th:field="*{role}" th:text="|role : *{role}|"></p>
    <br/>
</div>
<button type="button" th:text="홈으로이동" th:onclick="|location.href='@{/}'|"></button>
<br/>
<button type="button" id="followingButton" onclick="onClickFollowingButton(this)"></button>
<br/>
<div th:replace="~{board/boardList :: boardList(boardList=${boardList})}"></div>

</body>
</html>